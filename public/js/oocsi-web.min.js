var OOCSI=function(){function n(){l("CONNECTING to "+S),b=new WebSocket(S),b.onopen=function(n){t(n)},b.onclose=function(n){o(n)},b.onmessage=function(n){e(n)},b.onerror=function(n){c(n)}}function t(n){b.readyState==WebSocket.OPEN&&(f(d),O=!0),l("CONNECTED")}function o(n){l("DISCONNECTED")}function e(n){b.send(".");try{var t=JSON.parse(n.data);void 0!==E[t.recipient]?E[t.recipient](t):l("no handler for event: "+n.data)}catch(t){l("parse exception for event: "+n.data)}l("RESPONSE: "+n.data)}function c(n){l("ERROR: "+n.data)}function i(n){b&&b.readyState!=WebSocket.CONNECTING?n():setTimeout(function(){i(n)},200)}function u(){b&&b.close()}function f(n){b&&b.send(n)&&l("SENT: "+n)}function r(n){}function a(n,t){O&&f("sendjson "+n+" "+JSON.stringify(t))}function s(n,t){O&&(f("subscribe "+n),E[n]=t)}function N(n){O&&(f("unsubscribe "+n),E[n]=function(){})}var d,b,S="ws://localhost:9000/",E={},O=!1,l=r;return{connect:function(t,o,e){S=t,d=o&&o.length>0?o:"webclient_"+ +new Date,E[o]=e,n()},send:function(n,t){a(n,t)},subscribe:function(n,t){i(function(){s(n,t)})},unsubscribe:function(n){i(function(){N(n)})},close:function(){i(function(){u()})},handlers:function(){return E},logger:function(n){l=n}}}();